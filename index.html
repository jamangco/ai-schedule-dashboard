<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>데이터/AI 자격증 시험일정 (2025)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    .modal-open{overflow:hidden}
    .event-pill{
      font-size:10px; line-height:1;
      padding:2px 4px; border-radius:4px;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
      display:block;
    }
    .cell-clickable{cursor:pointer}
  </style>
</head>
<body class="min-h-screen bg-gray-50 p-2 sm:p-4">
  <div class="max-w-7xl mx-auto">
    <!-- 헤더 -->
    <div class="bg-white rounded-lg shadow-sm p-4 sm:p-6 mb-4 sm:mb-6">
      <div class="flex items-center justify-between">
        <button id="openCalendarBtn" class="h-6 w-6 sm:h-8 sm:w-8 text-blue-600 hover:text-blue-800 transition-colors cursor-pointer" title="달력으로 보기">
          <i data-lucide="calendar" class="h-full w-full"></i>
        </button>
        <div class="flex-1">
          <h1 class="text-center text-xl sm:text-2xl md:text-3xl font-bold text-gray-900">데이터/AI 자격증 시험일정</h1>
          <p class="text-center text-sm sm:text-base text-gray-600 mt-1">2025년도 데이터자격검정 및 AICE 시험일정을 한눈에 확인하세요</p>
        </div>
        <span class="w-8"></span>
      </div>

      <!-- 요약 카드 -->
      <div class="grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 mt-4 sm:mt-6">
        <div class="bg-blue-50 rounded-lg p-3 sm:p-4 text-center">
          <div class="flex items-center justify-center gap-2">
            <i data-lucide="file-text" class="h-4 w-4 sm:h-5 sm:w-5 text-blue-600"></i>
            <span class="text-xs sm:text-sm text-blue-600 font-medium">총 시험</span>
          </div>
          <p id="totalExams" class="text-lg sm:text-xl lg:text-2xl font-bold text-blue-900 mt-1">0회</p>
        </div>
        <div class="bg-green-50 rounded-lg p-3 sm:p-4 text-center">
          <div class="flex items-center justify-center gap-2">
            <i data-lucide="calendar" class="h-4 w-4 sm:h-5 sm:w-5 text-green-600"></i>
            <span class="text-xs sm:text-sm text-green-600 font-medium">이번달 시험</span>
          </div>
          <p id="monthExams" class="text-lg sm:text-xl lg:text-2xl font-bold text-green-900 mt-1">0회</p>
        </div>
        <div class="bg-purple-50 rounded-lg p-3 sm:p-4 text-center">
          <div class="flex items-center justify-center gap-2">
            <i data-lucide="alert-circle" class="h-4 w-4 sm:h-5 sm:w-5 text-purple-600"></i>
            <span class="text-xs sm:text-sm text-purple-600 font-medium">자격증 종류</span>
          </div>
          <p id="certTypes" class="text-lg sm:text-xl lg:text-2xl font-bold text-purple-900 mt-1">0개</p>
        </div>
        <div class="bg-orange-50 rounded-lg p-3 sm:p-4 text-center">
          <div class="flex items-center justify-center gap-2">
            <i data-lucide="clock" class="h-4 w-4 sm:h-5 sm:w-5 text-orange-600"></i>
            <span class="text-xs sm:text-sm text-orange-600 font-medium">접수중인 시험</span>
          </div>
          <p id="activeExams" class="text-lg sm:text-xl lg:text-2xl font-bold text-orange-900 mt-1">0회</p>
        </div>
      </div>
    </div>

    <!-- 필터: 1줄(검색), 2줄(선택들) -->
    <div class="bg-white rounded-lg shadow-sm p-3 sm:p-4 mb-4 sm:mb-6">
      <div class="mb-3">
        <div class="relative">
          <i data-lucide="search" class="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"></i>
          <input id="searchInput" type="text" placeholder="검색: 자격증/회차/유형"
                 class="w-full pl-9 pr-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-400"/>
        </div>
      </div>
      <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
        <select id="categorySelect" class="border rounded-lg px-3 py-2 text-sm"></select>
        <select id="subcategorySelect" class="border rounded-lg px-3 py-2 text-sm" disabled></select>
        <select id="monthSelect" class="border rounded-lg px-3 py-2 text-sm"></select>
        <select id="statusSelect" class="border rounded-lg px-3 py-2 text-sm">
          <option value="all">상태(전체)</option>
          <option value="active">접수중</option>
          <option value="upcoming">예정</option>
          <option value="closed">마감</option>
        </select>
      </div>
    </div>

    <!-- 리스트 -->
    <div id="examList" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-3 sm:gap-4"></div>
    <div id="noResultCard" class="hidden col-span-full bg-white border rounded-lg p-8 text-center text-gray-500">조건에 맞는 일정이 없습니다.</div>

    <!-- 캘린더 모달 -->
    <div id="calendarModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center z-50 p-1 pt-4 overflow-y-auto">
      <div class="bg-white rounded-lg shadow-xl w-full max-w-5xl">
        <div class="flex items-center justify-between p-3 border-b">
          <div class="flex items-center gap-2">
            <i data-lucide="calendar" class="h-5 w-5 text-blue-600"></i>
            <h2 class="text-sm sm:text-lg font-bold text-gray-900">시험일정 캘린더</h2>
          </div>
          <button id="closeCalendarBtn" class="text-gray-400 hover:text-gray-600 text-xl font-bold p-1">×</button>
        </div>

        <div class="flex items-center justify-between p-3 border-b">
          <button id="prevMonthBtn" class="p-2 rounded-lg hover:bg-gray-100 text-lg font-bold">←</button>
          <h3 id="calendarTitle" class="text-sm sm:text-lg font-semibold"></h3>
          <button id="nextMonthBtn" class="p-2 rounded-lg hover:bg-gray-100 text-lg font-bold">→</button>
        </div>

        <!-- 범례 -->
        <div class="px-4 pt-3">
          <div class="flex flex-wrap gap-2 text-xs text-gray-600">
            <span class="inline-flex items-center gap-1"><span class="w-3 h-3 rounded bg-yellow-200 border border-yellow-400"></span>접수 시작</span>
            <span class="inline-flex items-center gap-1"><span class="w-3 h-3 rounded bg-red-200 border border-red-400"></span>접수 마감</span>
            <span class="inline-flex items-center gap-1"><span class="w-3 h-3 rounded bg-blue-200 border border-blue-400"></span>시험일</span>
          </div>
        </div>

        <div class="p-2 sm:p-4">
          <div class="grid grid-cols-7 gap-0.5 mb-2">
            <div class="text-center text-xs font-medium text-gray-500 py-1">일</div>
            <div class="text-center text-xs font-medium text-gray-500 py-1">월</div>
            <div class="text-center text-xs font-medium text-gray-500 py-1">화</div>
            <div class="text-center text-xs font-medium text-gray-500 py-1">수</div>
            <div class="text-center text-xs font-medium text-gray-500 py-1">목</div>
            <div class="text-center text-xs font-medium text-gray-500 py-1">금</div>
            <div class="text-center text-xs font-medium text-gray-500 py-1">토</div>
          </div>
          <div id="calendarGrid" class="grid grid-cols-7 gap-0.5"></div>
        </div>
      </div>
    </div>

    <!-- 날짜 전체 목록 모달 -->
    <div id="dayEventsModal" class="hidden fixed inset-0 bg-black/50 z-[60] flex items-center justify-center p-3">
      <div class="bg-white w-full max-w-lg rounded-lg shadow-xl">
        <div class="flex items-center justify-between p-3 border-b">
          <h4 id="dayEventsTitle" class="font-semibold"></h4>
          <button id="closeDayEventsBtn" class="text-gray-500 hover:text-gray-700 text-xl font-bold">×</button>
        </div>
        <div id="dayEventsBody" class="p-3 space-y-2 text-sm"></div>
      </div>
    </div>

    <!-- 출처/안내 -->
    <div class="mt-8 text-center">
      <p class="text-blue-600 text-sm font-medium">*데이터 출처: 한국데이터산업진흥원 / AICE 공식사이트</p>
      <p class="text-gray-500 text-xs mt-1">시험 일정은 기관 사정에 따라 변경될 수 있으니, 정확한 정보는 공식 사이트를 확인해주세요.</p>
    </div>
  </div>

  <script>
    /* ---------- 원본 데이터 ---------- */
    const rawData = [
      /* AICE Basic */
      { certification: 'AICE Basic', session: '1회', type: '정기', applicationPeriod: '01.13~02.07', examDate: '02.15(토)', resultAnnouncement: '03.01' },
      { certification: 'AICE Basic', session: '2회', type: '정기', applicationPeriod: '03.24~04.18', examDate: '04.26(토)', resultAnnouncement: '05.10' },
      { certification: 'AICE Basic', session: '3회', type: '정기', applicationPeriod: '05.26~06.20', examDate: '06.28(토)', resultAnnouncement: '07.12' },
      { certification: 'AICE Basic', session: '4회', type: '정기', applicationPeriod: '07.21~08.15', examDate: '08.23(토)', resultAnnouncement: '09.06' },
      { certification: 'AICE Basic', session: '5회', type: '정기', applicationPeriod: '09.22~10.17', examDate: '10.25(토)', resultAnnouncement: '11.08' },
      { certification: 'AICE Basic', session: '6회', type: '정기', applicationPeriod: '11.17~12.12', examDate: '12.20(토)', resultAnnouncement: '01.03' },

      /* AICE Associate */
      { certification: 'AICE Associate', session: '2회', type: '정기', applicationPeriod: '03.24~04.18', examDate: '04.26(토)', resultAnnouncement: '05.10' },
      { certification: 'AICE Associate', session: '3회', type: '정기', applicationPeriod: '05.26~06.20', examDate: '06.28(토)', resultAnnouncement: '07.12' },
      { certification: 'AICE Associate', session: '4회', type: '정기', applicationPeriod: '07.21~08.15', examDate: '08.23(토)', resultAnnouncement: '09.06' },
      { certification: 'AICE Associate', session: '5회', type: '정기', applicationPeriod: '09.22~10.17', examDate: '10.25(토)', resultAnnouncement: '11.08' },
      { certification: 'AICE Associate', session: '6회', type: '정기', applicationPeriod: '11.17~12.12', examDate: '12.20(토)', resultAnnouncement: '01.03' },

      /* AICE Professional */
      { certification: 'AICE Professional', session: '1회', type: '정기', applicationPeriod: '01.13~02.08', examDate: '02.15(토)', resultAnnouncement: '03.01' },
      { certification: 'AICE Professional', session: '3회', type: '정기', applicationPeriod: '05.26~06.21', examDate: '06.28(토)', resultAnnouncement: '07.12' },
      { certification: 'AICE Professional', session: '5회', type: '정기', applicationPeriod: '09.22~10.18', examDate: '10.25(토)', resultAnnouncement: '11.08' },

      /* AICE Junior */
      { certification: 'AICE Junior', session: '1회', type: '정기', applicationPeriod: '12.23~01.18', examDate: '01.25(토)', resultAnnouncement: '02.08' },
      { certification: 'AICE Junior', session: '2회', type: '정기', applicationPeriod: '02.24~03.22', examDate: '03.29(토)', resultAnnouncement: '04.12' },
      { certification: 'AICE Junior', session: '3회', type: '정기', applicationPeriod: '04.28~05.24', examDate: '05.31(토)', resultAnnouncement: '06.14' },
      { certification: 'AICE Junior', session: '4회', type: '정기', applicationPeriod: '06.23~07.19', examDate: '07.26(토)', resultAnnouncement: '08.09' },
      { certification: 'AICE Junior', session: '5회', type: '정기', applicationPeriod: '08.25~09.20', examDate: '09.27(토)', resultAnnouncement: '10.11' },
      { certification: 'AICE Junior', session: '6회', type: '정기', applicationPeriod: '10.27~11.22', examDate: '11.29(토)', resultAnnouncement: '12.13' },

      /* AICE Future */
      { certification: 'AICE Future', session: '1회', type: '정기', applicationPeriod: '12.23~01.18', examDate: '01.25(토)', resultAnnouncement: '02.08' },
      { certification: 'AICE Future', session: '2회', type: '정기', applicationPeriod: '02.24~03.21', examDate: '03.29(토)', resultAnnouncement: '04.12' },
      { certification: 'AICE Future', session: '3회', type: '정기', applicationPeriod: '04.28~05.24', examDate: '05.31(토)', resultAnnouncement: '06.14' },
      { certification: 'AICE Future', session: '4회', type: '정기', applicationPeriod: '06.23~07.19', examDate: '07.26(토)', resultAnnouncement: '08.09' },
      { certification: 'AICE Future', session: '5회', type: '정기', applicationPeriod: '08.25~09.20', examDate: '09.27(토)', resultAnnouncement: '10.11' },
      { certification: 'AICE Future', session: '6회', type: '정기', applicationPeriod: '10.27~11.22', examDate: '11.29(토)', resultAnnouncement: '12.13' },

      /* 빅데이터 분석기사 */
      { certification: '빅데이터 분석기사', session: '제10회', type: '필기', applicationPeriod: '3.4~10', examDate: '4.5(토)', resultAnnouncement: '4.25' },
      { certification: '빅데이터 분석기사', session: '제10회', type: '실기', applicationPeriod: '5.19~23', examDate: '6.21(토)', resultAnnouncement: '7.11' },
      { certification: '빅데이터 분석기사', session: '제11회', type: '필기', applicationPeriod: '8.4~8', examDate: '9.6(토)', resultAnnouncement: '9.26' },
      { certification: '빅데이터 분석기사', session: '제11회', type: '실기', applicationPeriod: '10.27~10.31', examDate: '11.29(토)', resultAnnouncement: '12.19' },

      /* 데이터분석 전문가 */
      { certification: '데이터분석 전문가', session: '제34회', type: '필기', applicationPeriod: '1.20~24', examDate: '2.22(토)', resultAnnouncement: '3.21' },
      { certification: '데이터분석 전문가', session: '제34회', type: '실기', applicationPeriod: '3.24~28', examDate: '4.26(토)', resultAnnouncement: '5.23' },
      { certification: '데이터분석 전문가', session: '제35회', type: '필기', applicationPeriod: '7.7~7.11', examDate: '8.9(토)', resultAnnouncement: '9.5' },
      { certification: '데이터분석 전문가', session: '제35회', type: '실기', applicationPeriod: '9.15~19', examDate: '10.18(토)', resultAnnouncement: '11.14' },

      /* 데이터분석 준전문가 */
      { certification: '데이터분석 준전문가', session: '제44회', type: '단일', applicationPeriod: '1.20~24', examDate: '2.22(토)', resultAnnouncement: '3.21' },
      { certification: '데이터분석 준전문가', session: '제45회', type: '단일', applicationPeriod: '4.14~18', examDate: '5.17(토)', resultAnnouncement: '6.13' },
      { certification: '데이터분석 준전문가', session: '제46회', type: '단일', applicationPeriod: '7.7~11', examDate: '8.9(토)', resultAnnouncement: '9.5' },
      { certification: '데이터분석 준전문가', session: '제47회', type: '단일', applicationPeriod: '9.22~9.26', examDate: '11.2(일)', resultAnnouncement: '11.28' },

      /* SQL 전문가/개발자 */
      { certification: 'SQL 전문가', session: '제52회', type: '단일', applicationPeriod: '2.3~2.7', examDate: '3.8(토)', resultAnnouncement: '4.4' },
      { certification: 'SQL 전문가', session: '제53회', type: '단일', applicationPeriod: '7.21~25', examDate: '8.23(토)', resultAnnouncement: '9.19' },
      { certification: 'SQL 개발자', session: '제56회', type: '단일', applicationPeriod: '2.3~2.7', examDate: '3.8(토)', resultAnnouncement: '4.4' },
      { certification: 'SQL 개발자', session: '제57회', type: '단일', applicationPeriod: '4.28~5.2', examDate: '5.31(토)', resultAnnouncement: '6.27' },
      { certification: 'SQL 개발자', session: '제58회', type: '단일', applicationPeriod: '7.21~25', examDate: '8.23(토)', resultAnnouncement: '9.19' },
      { certification: 'SQL 개발자', session: '제59회', type: '단일', applicationPeriod: '10.13~17', examDate: '11.16(일)', resultAnnouncement: '12.12' },

      /* 데이터아키텍처 */
      { certification: '데이터아키텍처 전문가', session: '제63회', type: '단일', applicationPeriod: '2.17~2.21', examDate: '3.22(토)', resultAnnouncement: '4.18' },
      { certification: '데이터아키텍처 전문가', session: '제64회', type: '단일', applicationPeriod: '8.25~29', examDate: '9.27(토)', resultAnnouncement: '10.24' },
      { certification: '데이터아키텍처 준전문가', session: '제58회', type: '단일', applicationPeriod: '2.17~2.21', examDate: '3.22(토)', resultAnnouncement: '4.18' },
      { certification: '데이터아키텍처 준전문가', session: '제59회', type: '단일', applicationPeriod: '8.25~29', examDate: '9.27(토)', resultAnnouncement: '10.24' }
    ];

    /* ---------- 상태 ---------- */
    let examData = [];
    let filteredData = [];
    let searchTerm = '';
    let selectedCategory = 'all';
    let selectedSubCategory = 'all';
    let selectedMonth = 'all';
    let selectedStatus = 'all';
    let currentCalendarDate = new Date();

    const categories = ['all', '빅데이터', 'SQL', '데이터분석', '데이터아키텍처', 'AICE'];
    const months = ['all', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12'];

    function getSubCategories(category) {
      if (category === 'AICE') return ['all', 'Basic', 'Associate', 'Professional', 'Junior', 'Future'];
      if (category === '빅데이터') return ['all', '분석기사'];
      if (category === 'SQL') return ['all', '전문가', '개발자'];
      if (category === '데이터분석') return ['all', '전문가', '준전문가'];
      if (category === '데이터아키텍처') return ['all', '전문가', '준전문가'];
      return ['all'];
    }

    function parseDate(dateStr) {
      if (!dateStr || dateStr === '-') return null;
      try {
        const clean = dateStr.split('(')[0]; // 'MM.DD'
        if (clean.includes('.')) {
          const [m, d] = clean.split('.');
          const y = 2025;
          const date = new Date(`${y}-${String(m).padStart(2,'0')}-${String(d||'1').padStart(2,'0')}`);
          return isNaN(date.getTime()) ? null : date;
        }
      } catch {}
      return null;
    }

    // 접수기간 'MM.DD~MM.DD' 또는 'MM.DD~DD'
    function parseApplicationPeriod(period) {
      if (!period || !period.includes('~')) return null;
      const [startStr, endStr] = period.split('~').map(s => s.trim());
      const [sM, sD] = startStr.split('.');
      let eMonth, eDay;
      if (endStr.includes('.')) {
        const [eM, eD] = endStr.split('.');
        eMonth = parseInt(eM, 10); eDay = parseInt(eD, 10);
      } else {
        eMonth = parseInt(sM, 10); eDay = parseInt(endStr, 10);
      }
      const y = 2025;
      const start = new Date(y, parseInt(sM,10)-1, parseInt(sD,10), 0,0,0);
      const end = new Date(y, eMonth-1, eDay, 23,59,59);
      if (isNaN(start.getTime()) || isNaN(end.getTime())) return null;
      return { start, end };
    }

    function getExamStatus(applicationPeriod) {
      try {
        const ap = parseApplicationPeriod(applicationPeriod);
        if (!ap) return 'upcoming';
        const now = new Date();
        if (now < ap.start) return 'upcoming';
        if (now > ap.end) return 'closed';
        return 'active';
      } catch { return 'upcoming'; }
    }

    /* ---------- 캘린더 이벤트 (정렬: 접수시작→마감→시험) ---------- */
    function getCalendarEvents() {
      const events = [];
      examData.forEach(item => {
        const title = `${item.certification}`; // 자격증명만
        const ap = parseApplicationPeriod(item.applicationPeriod);
        if (ap) {
          events.push({ kind: 'applyStart', date: ap.start, title });
          events.push({ kind: 'applyEnd',   date: ap.end,   title });
        }
        const eDate = parseDate(item.examDate);
        if (eDate) events.push({ kind: 'exam', date: eDate, title });
      });
      return events;
    }

    function getEventsForDate(date) {
      const events = getCalendarEvents();
      return events.filter(ev => {
        const d = new Date(ev.date);
        return d.getFullYear() === date.getFullYear() &&
               d.getMonth() === date.getMonth() &&
               d.getDate() === date.getDate();
      }).sort((a,b)=>{
        const order = {applyStart:0, applyEnd:1, exam:2};
        if (order[a.kind] !== order[b.kind]) return order[a.kind]-order[b.kind];
        return (a.title||'').localeCompare(b.title||'');
      });
    }

    /* ---------- 리스트/요약 ---------- */
    function renderStats() {
      const totalEl = document.getElementById('totalExams');
      const monthEl = document.getElementById('monthExams');
      const typesEl = document.getElementById('certTypes');
      const activeEl = document.getElementById('activeExams');

      const now = new Date();
      const currentMonthStr = String(now.getMonth() + 1);

      totalEl.textContent = `${examData.length}회`;
      monthEl.textContent = `${examData.filter(i => i.examMonth === currentMonthStr).length}회`;
      typesEl.textContent = `${new Set(examData.map(i => i.certification)).size}개`;
      activeEl.textContent = `${examData.filter(i => getExamStatus(i.applicationPeriod) === 'active').length}회`;
    }

    function statusBadgeHTML(status) {
      const map = {
        active:   { bg: 'bg-green-100',  text: 'text-green-800',  label: '접수중' },
        upcoming: { bg: 'bg-blue-100',   text: 'text-blue-800',   label: '예정' },
        closed:   { bg: 'bg-gray-100',   text: 'text-gray-800',   label: '마감' }
      };
      const c = map[status] || map.upcoming;
      return `<span class="${c.bg} ${c.text} px-2 py-1 rounded-full text-xs">${c.label}</span>`;
    }

    function renderList() {
      const list = document.getElementById('examList');
      const empty = document.getElementById('noResultCard');
      list.innerHTML = '';

      if (filteredData.length === 0) {
        empty.classList.remove('hidden');
        return;
      }
      empty.classList.add('hidden');

      filteredData.forEach(item => {
        const status = getExamStatus(item.applicationPeriod);
        const card = document.createElement('div');
        card.className = 'bg-white rounded-lg shadow-sm p-4 border';
        card.innerHTML = `
          <div class="flex items-start justify-between gap-2">
            <div>
              <h3 class="font-bold text-gray-900">
                ${item.certification} <span class="text-blue-600">${item.session}</span>
              </h3>
              <p class="text-sm text-gray-500 mt-0.5">${item.type}</p>
            </div>
            ${statusBadgeHTML(status)}
          </div>
          <div class="mt-3 text-sm text-gray-700 space-y-1.5">
            <p><span class="text-gray-500 mr-2">접수:</span>${item.applicationPeriod}</p>
            <p><span class="text-gray-500 mr-2">시험:</span>${item.examDate}</p>
            ${item.resultAnnouncement ? `<p><span class="text-gray-500 mr-2">발표:</span>${item.resultAnnouncement}</p>` : ''}
            <p><span class="text-gray-500 mr-2">합격기준:</span>${item.passingScore}</p>
          </div>
        `;
        list.appendChild(card);
      });
    }

    function renderFilters() {
      const categoryEl = document.getElementById('categorySelect');
      const subEl = document.getElementById('subcategorySelect');
      const monthEl = document.getElementById('monthSelect');

      categoryEl.innerHTML = '';
      ['all', ...categories.slice(1)].forEach(c => {
        const opt = document.createElement('option');
        opt.value = c; opt.textContent = (c === 'all') ? '전체' : c;
        categoryEl.appendChild(opt);
      });
      categoryEl.value = selectedCategory;

      const subs = getSubCategories(selectedCategory);
      subEl.innerHTML = '';
      subs.forEach(s => {
        const opt = document.createElement('option');
        opt.value = s; opt.textContent = (s === 'all') ? '전체' : s;
        subEl.appendChild(opt);
      });
      subEl.disabled = subs.length === 1;
      subEl.value = selectedSubCategory;

      monthEl.innerHTML = '';
      months.forEach(m => {
        const opt = document.createElement('option');
        opt.value = m; opt.textContent = (m === 'all') ? '월(전체)' : `${m}월`;
        monthEl.appendChild(opt);
      });
      monthEl.value = selectedMonth;
    }

    function applyFilter() {
      filteredData = examData.filter(item => {
        const s = (searchTerm || '').toLowerCase();
        const matchesSearch =
          (item.certification || '').toLowerCase().includes(s) ||
          (item.session || '').toLowerCase().includes(s) ||
          (item.type || '').toLowerCase().includes(s);

        const matchesCategory =
          selectedCategory === 'all' ||
          (item.certification || '').toLowerCase().includes(selectedCategory.toLowerCase());

        const matchesSubCategory =
          selectedSubCategory === 'all' ||
          (item.certification || '').toLowerCase().includes(selectedSubCategory.toLowerCase());

        const matchesMonth =
          selectedMonth === 'all' || (item.examMonth === selectedMonth);

        const status = getExamStatus(item.applicationPeriod);
        const matchesStatus = selectedStatus === 'all' || status === selectedStatus;

        return matchesSearch && matchesCategory && matchesSubCategory && matchesMonth && matchesStatus;
      });

      renderList();
    }

    /* ---------- 날짜 전체 목록 모달 ---------- */
    const dayEventsModal = document.getElementById('dayEventsModal');
    const dayEventsTitle = document.getElementById('dayEventsTitle');
    const dayEventsBody  = document.getElementById('dayEventsBody');
    document.getElementById('closeDayEventsBtn').addEventListener('click', ()=> {
      dayEventsModal.classList.add('hidden');
    });

    function openDayEventsModal(date, events) {
      dayEventsTitle.textContent = `${date.getFullYear()}년 ${date.getMonth()+1}월 ${date.getDate()}일 일정`;
      dayEventsBody.innerHTML = '';
      const colorMap = {
        applyStart: 'bg-yellow-200 text-yellow-900 border border-yellow-400',
        applyEnd:   'bg-red-200 text-red-900 border border-red-400',
        exam:       'bg-blue-200 text-blue-900 border border-blue-400'
      };
      events.forEach(ev=>{
        const row = document.createElement('div');
        row.className = 'flex items-center gap-2';
        const dot = document.createElement('span');
        dot.className = `w-3 h-3 rounded ${colorMap[ev.kind]}`;
        const text = document.createElement('span');
        text.textContent = ev.title; // 자격증명만
        text.className = 'text-gray-800';
        row.appendChild(dot);
        row.appendChild(text);
        dayEventsBody.appendChild(row);
      });
      dayEventsModal.classList.remove('hidden');
    }

    /* ---------- 캘린더 렌더 (3개만 표시 + ''' 표시 + 날짜 클릭 시 전체 보기) ---------- */
    function renderCalendarHeader() {
      const title = document.getElementById('calendarTitle');
      title.textContent = `${currentCalendarDate.getFullYear()}년 ${currentCalendarDate.getMonth() + 1}월`;
    }

    function renderCalendarGrid() {
      const grid = document.getElementById('calendarGrid');
      grid.innerHTML = '';

      const y = currentCalendarDate.getFullYear();
      const m = currentCalendarDate.getMonth();
      const first = new Date(y, m, 1);
      const last = new Date(y, m + 1, 0);
      const days = last.getDate();
      const startDow = first.getDay();

      // 앞쪽 공백
      for (let i = 0; i < startDow; i++) {
        const div = document.createElement('div');
        div.className = 'h-24';
        grid.appendChild(div);
      }

      const MAX_SHOW = 3; // 요청사항: 3개만 보이기

      for (let day = 1; day <= days; day++) {
        const cellDate = new Date(y, m, day);
        const events = getEventsForDate(cellDate);

        const cell = document.createElement('div');
        cell.className = 'h-24 border rounded p-1 bg-white flex flex-col';

        const dayLabel = document.createElement('div');
        dayLabel.className = 'text-[10px] sm:text-xs text-gray-600';
        dayLabel.textContent = day;

        const listWrap = document.createElement('div');
        listWrap.className = 'mt-1 space-y-1 overflow-hidden';

        const show = events.slice(0, MAX_SHOW);
        show.forEach(ev => {
          const pill = document.createElement('div');
          pill.className =
            'event-pill ' +
            (ev.kind === 'applyStart' ? 'bg-yellow-200 text-yellow-900 border border-yellow-400' :
             ev.kind === 'applyEnd'   ? 'bg-red-200 text-red-900 border border-red-400' :
                                        'bg-blue-200 text-blue-900 border border-blue-400');
          pill.textContent = ev.title;
          pill.title = ev.title;
          listWrap.appendChild(pill);
        });

        const hiddenCount = events.length - show.length;
        if (hiddenCount > 0) {
          // ''' 표시
          const more = document.createElement('div');
          more.className = 'event-pill bg-gray-100 text-gray-700 border border-gray-300 w-fit';
          more.textContent = "'''";
          listWrap.appendChild(more);

          // 날짜 셀 클릭, ''' 클릭 모두 모달 오픈
          cell.classList.add('cell-clickable');
          const openAll = (e) => {
            e.stopPropagation();
            openDayEventsModal(cellDate, events);
          };
          more.addEventListener('click', openAll);
          cell.addEventListener('click', openAll);
        }

        cell.appendChild(dayLabel);
        cell.appendChild(listWrap);
        grid.appendChild(cell);
      }
    }

    /* ---------- 초기화 ---------- */
    function init() {
      // passingScore 일괄 60점 + examMonth 추가 + 정렬
      examData = rawData
        .map(item => {
          const head = (item.examDate || '').split('(')[0];
          const examMonth = (head && head.includes('.')) ? head.split('.')[0] : head;
          return { ...item, examMonth, passingScore: '60점' };
        })
        .sort((a, b) => (parseInt(a.examMonth || '0', 10)) - (parseInt(b.examMonth || '0', 10)));

      filteredData = [...examData];

      renderStats(); renderFilters(); renderList();

      // 필터 이벤트
      document.getElementById('searchInput').addEventListener('input', e => { searchTerm = e.target.value || ''; applyFilter(); });
      document.getElementById('categorySelect').addEventListener('change', e => {
        selectedCategory = e.target.value; selectedSubCategory = 'all'; renderFilters(); applyFilter();
      });
      document.getElementById('subcategorySelect').addEventListener('change', e => { selectedSubCategory = e.target.value; applyFilter(); });
      document.getElementById('monthSelect').addEventListener('change', e => { selectedMonth = e.target.value; applyFilter(); });
      document.getElementById('statusSelect').addEventListener('change', e => { selectedStatus = e.target.value; applyFilter(); });

      // 캘린더 컨트롤
      document.getElementById('openCalendarBtn').addEventListener('click', () => {
        document.getElementById('calendarModal').classList.remove('hidden');
        document.body.classList.add('modal-open');
        renderCalendarHeader();
        renderCalendarGrid();
        lucide.createIcons();
      });
      document.getElementById('closeCalendarBtn').addEventListener('click', () => {
        document.getElementById('calendarModal').classList.add('hidden');
        document.body.classList.remove('modal-open');
      });
      document.getElementById('prevMonthBtn').addEventListener('click', () => { currentCalendarDate.setMonth(currentCalendarDate.getMonth() - 1); renderCalendarHeader(); renderCalendarGrid(); });
      document.getElementById('nextMonthBtn').addEventListener('click', () => { currentCalendarDate.setMonth(currentCalendarDate.getMonth() + 1); renderCalendarHeader(); renderCalendarGrid(); });

      lucide.createIcons();
    }

    init();
  </script>
</body>
</html>
